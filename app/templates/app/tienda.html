{% extends "app/base.html" %}
{% load static %}
{% load humanize %}

{% block contenido_fh %}
<!--SLIDE-->
<div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel">
  <div class="carousel-indicators">
    <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
    <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
    <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2" aria-label="Slide 3"></button>
  </div>
  <div class="carousel-inner">
    <div class="carousel-item active">
      <img src="{% static 'app/img/slide1.png' %}" class="d-block w-100" alt="...">
      <div class="carousel-caption d-none d-md-block">
        <h5>FERREHOUSE</h5>
        <a href="{% url 'nosotros' %}"><button class="btn btn-dark" type="submit">Nosotros</button></a>
      </div>
    </div>
    <div class="carousel-item">
      <img src="{% static 'app/img/slide2.png' %}" class="d-block w-100" alt="...">
      <div class="carousel-caption d-none d-md-block">
        <h5>OFERTAS EN HERRAMIENTAS MANUALES</h5>
        <p>Descubre las ofertas más destacadas en herramientas manuales en nuestro portal web de FERREHOUSE. Explora nuestra amplia selección y encuentra las herramientas que necesitas para tus proyectos.</p>
      </div>
    </div>
    <div class="carousel-item">
      <img src="{% static 'app/img/ferre4.png' %}" class="d-block w-100" alt="...">
      <div class="carousel-caption d-none d-md-block">
        <h5>OFERTAS EN HERRAMIENTAS ELECTRICAS</h5>
        <p>Descubre las ofertas más destacadas en herramientas electricas en nuestro portal web de FERREHOUSE. Explora nuestra amplia selección y encuentra las herramientas que necesitas para tus proyectos.</p>
      </div>
    </div>
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>
</div>

<br><br><br><br><br><br><br><br>
<div id="contenido-producto" class="productos-container">
  {% if productos %}
    {% for p in productos %}
    <div class="producto">
        <div class="contenedor">
            <div class="desc">-47%</div>
            {% if p.imagen %}
            <img src="{{ p.imagen.url }}" alt="Producto" class="producto-imagen">
            {% endif %}
            <div class="detalle-producto">
                <h5 class="marca">{{ p.marca|capfirst }}</h5>
                <p class="codigo">{{ p.codigo }}</p>
                <h3 class="titulo">{{ p.nombre }}</h3>
                <h4 class="precio">${{ p.precio|intcomma }}</h4>
            </div>
            <div class="text-center">
                <a href="{% url 'producto' p.id %}" class="btn btn-dark">Ver Producto</a>
                <br>
                <button class="btn btn-dark add-to-cart" data-id="{{ p.id }}">Agregar al Carrito</button>
            </div>
        </div>
    </div>
    {% endfor %}
  {% else %}
    <p>No hay productos disponibles.</p>
  {% endif %}
</div>
{% endblock %}

{% block scripts %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function() {
    $('.add-to-cart').click(function() {
        var productId = $(this).data('id');
        var cantidad = 1; // Puedes ajustar la cantidad según tus necesidades
        $.post("{% url 'agregar_al_carrito' %}", {
            producto_id: productId,
            cantidad: cantidad,
            csrfmiddlewaretoken: '{{ csrf_token }}'
        }).done(function(data) {
            if (data.status === 'ok') {
                alert(data.message);
            } else {
                alert('Hubo un error al agregar el producto al carrito.');
            }
        }).fail(function() {
            alert('Error en la solicitud.');
        });
    });
});
</script>
<!--CONTENIDO DE LOS PRODUCTOS TIENDA-->
<style>
  .productos-container {
    display: flex;
    overflow-x: auto; /* Habilita la barra de desplazamiento horizontal si los productos no caben en la pantalla */
    gap: 20px; /* Espacio entre los productos */
  }
  
  .producto {
    border: 1px solid #ccc; /* Borde alrededor del producto */
    padding: 20px; /* Espacio interno dentro del producto */
    flex-shrink: 0; /* Evita que los productos se reduzcan para ajustarse al contenedor */
  }
  
  .contenedor {
    position: relative; /* Para alinear el contenido dentro del producto */
  }
  
  .desc {
    position: absolute;
    top: 0;
    right: 0;
    background-color: #ff0000; /* Color de fondo para el descuento */
    color: #fff;
    padding: 5px 10px;
  }
  
  .detalle-producto {
    margin-top: 10px; /* Espacio entre la imagen y el contenido del producto */
  }
  
  .marca {
    font-size: 16px;
  }
  
  .codigo {
    font-size: 14px;
  }
  
  .titulo {
    font-size: 18px;
    margin-top: 5px;
  }
  
  .precio {
    margin-top: 5px;
    font-size: 16px;
    color: #007bff; /* Color del precio */
  }
  
  .btn {
    margin-top: 10px; /* Espacio entre el botón y el precio */
  }
  
  .producto-imagen {
    width: 150px; /* Tamaño de la imagen */
    height: auto; /* La altura se ajustará automáticamente para mantener la proporción */
  }
  
</style>
{% endblock %}